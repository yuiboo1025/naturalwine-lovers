<!-- ナチュール記録ボタン -->
<%= render 'public/wines/post_wine-btn' %>

<div class="container my-4">

  <div class="row">
    <div class="col text-center">
      <% provide(:title,'ユーザー検索') %>
      <h4><%= title %></h4>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <%= render 'search_form', q: q, url:  %>
    </div>
  </div>

  <div class="row my-4 text-center">
    <div class="col">

      <% unless members.empty? %>

      <table class="table member_index_table">
        <thead>
          <th>ユーザー名</th>
          <th>在住県</th>
          <th>好きなワインのジャンル</th>
          <th>ナチュール記録数</th>
          <th>フォロー数</th>
          <th>フォロワー数</th>
          <th></th>
        </thead>
        <% members.each do |member| %>
        <tbody>
          <tr class="member_index_tbody_tr" data-href="wines/myindex/<%= member.id%>">
            <td>
              <%#= link_to wines_myindex_path(member) do %>
                <%= image_tag member.get_profile_image(60,60), class: "rounded-circle" %>
                <%= member.name %>
              <%# end %>
            </td>
            <td><%= member.prefecture %></td>
            <td><%= member.favorite_genre %></td>
            <td><%= member.wines.count %></td>
            <td><%= member.followings.where(is_deleted: false).count %></td>
            <td><%= member.followers.where(is_deleted: false).count %></td>
            <td>
              <% if member_signed_in? %>
                <% if current_member != member %>
                  <% if current_member.following?(member) %>
                    <%= link_to "フォロー外す", member_relationships_path(member.id), method: :delete, class: "btn unfollow_btn pr-3 pl-3 ml-4" %>
                  <% else %>
                    <%= link_to "フォローする", member_relationships_path(member.id), method: :post, class: "btn follow_btn pr-3 pl-3 ml-4" %>
                  <% end %>
                <% end %>
              <% end %>
            </td>
          </tr>
        </tbody>
        <% end %>
      </table>

      <% else %>
      <p>
      ユーザーが見つかりませんでした。<br>
      お探しのユーザー名を確認してください。
      </p>
      <% end %>

    </div>
  </div>
  
  　<div class="d-flex justify-content-center">
        <%= paginate members, theme: 'bootstrap-5' %>
      </div>

  
</div>

   　　
<style>
  .follow_btn {
    color: #fff;
    background-color: #20b2aa;
  }

  .unfollow_btn {
    color: #fff;
    background-color: #a9a9a9;
  }
  
  .member_index_table tbody tr:hover {
    background-color: #f7f2c6;
  }
  
</style>

<script>
  $(document).on("turbolinks:load", function() {
    $(".member_index_tbody_tr").on('click', function() {
      window.location = $(this).data("href");
    });
  });
</script>